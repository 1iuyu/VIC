# Variable Infiltration Capacity (VIC) Model
## 这是一个基于VIC-5.1.0的修改版模型
主要的修改内容：
- 增加了对冰川质量和能量平衡计算的支持
- 增加了新的雨雪划分参数化方案
- 增加了水文响应单元提高对模型空间异质性的描述

## 修改说明：
1. 冰川质量和能量平衡计算<br>

   冰川过程的计算参考了PCIC的VIC-GL模型（VIC Glacier），而后者基于的VIC版本太旧，新版VIC在蒸散发等过程都有相关改进，有必要在新版VIC的基础上增加对于冰川过程的计算。

2. 新的雨雪划分参数化方案<br>

   原版VIC中基于温度阈值的雨雪划分会严重低估降雪量，大量研究表明，将相对湿度、海拔和气温结合使用可以更好地预测降水相态。修改后VIC的采用基于Ding et al. (2014)的参数化方案，根据每个单元的相对湿度、海拔和湿球温度等地理和气象信息更精确的进行雨雪划分。<br>
   目前修改后的模型保留了原版基于温度阈值的雨雪划分方案以及基于Ding et al. (2014)的参数化方案，运行模型前需要在全局文件中选择相应的参数化方案。<br>
   
   （注：修改了原版模型处理气象强迫的计算逻辑，当输入降雨和降雪但没有降水数据时，原版VIC会将降雨和降雪相加计算降水量，然后调用calc_rainonly函数重新计算降雨和降雪量，而修改后的模型支持直接根据输入的降雨和降雪数据进行相关的水文计算，即模型会首先检查输入的气候强迫数据中是否包含降雨和降雪数据，如果包含则直接根据输入数据进行后续计算，如果只有降水数据则调用calc_rainonly计算降雨和降雪量。由于Ding et al.的参数化方案是根据日尺度数据进行计算的，当处理亚日尺度数据时可能存在不确定性，因此我们推荐直接输入降雨和降雪数据进行计算，推荐*CMFD-2.0*版包含满足VIC-5运行所需的7个变量同时也包括降雨和降雪数据）
   
   下面的字段需要在全局文件中指定：TEMP_TH_TYPE
   
   1. 原版基于温度阈值的VIC需要MAX_SNOW_TEMP和MIN_RAIN_TEMP两个参数（默认分别为0.5和-0.5），这两个参数目前已经修改为在土壤文件中。<br>
   ```
   TEMP_TH_TYPE VIC_CLASSIC
   ```
   2. 基于Ding et al. (2014)的参数化方案（推荐，默认设置）<br> 
   ```
   TEMP_TH_TYPE VIC_DING
   ```
3. 水文响应单元<br>

参考了VIC-GL模型中的相关概念，但对energy_bal_struct，snow_data_struct等数组的结构进行了修改。


   


